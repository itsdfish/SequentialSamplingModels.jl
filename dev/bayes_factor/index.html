<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Comparison · SequentialSamplingModels</title><meta name="title" content="Model Comparison · SequentialSamplingModels"/><meta property="og:title" content="Model Comparison · SequentialSamplingModels"/><meta property="twitter:title" content="Model Comparison · SequentialSamplingModels"/><meta name="description" content="Documentation for SequentialSamplingModels."/><meta property="og:description" content="Documentation for SequentialSamplingModels."/><meta property="twitter:description" content="Documentation for SequentialSamplingModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SequentialSamplingModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SequentialSamplingModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../aDDM/">Attentional Drift Diffusion (aDDM)</a></li><li><a class="tocitem" href="../cddm/">Circular Drift Diffusion Model (CDDM)</a></li><li><a class="tocitem" href="../DDM/">Drift Diffusion Model (DDM)</a></li><li><a class="tocitem" href="../ex_gaussian/">Ex-Gaussian Distribution</a></li><li><a class="tocitem" href="../lca/">Leaky Competing Accumulator (LCA)</a></li><li><a class="tocitem" href="../lba/">Linear Ballistic Accumulator (LBA)</a></li><li><a class="tocitem" href="../lnr/">Lognormal Race Model (LNR)</a></li><li><a class="tocitem" href="../maaDDM/">Muti-attribute Attentional Drift Diffusion Model</a></li><li><a class="tocitem" href="../mdft/">Multi-attribute Decision Field Theory</a></li><li><a class="tocitem" href="../mlba/">Multi-attribute Linear Ballistic Accumulator</a></li><li><a class="tocitem" href="../poisson_race/">Poisson Race</a></li><li><a class="tocitem" href="../rdm/">Racing Diffusion Model (RDM)</a></li><li><a class="tocitem" href="../stDDM/">Starting-time Drift Diffusion Model (stDDM)</a></li><li><a class="tocitem" href="../wald/">Wald Model</a></li><li><a class="tocitem" href="../wald_mixture/">Wald Mixture Model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Parameter Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mode_estimation/">Mode Estimation</a></li><li><a class="tocitem" href="../turing_simple/">Simple Bayesian Model</a></li><li><a class="tocitem" href="../turing_advanced/">Advanced Model Specification</a></li><li><a class="tocitem" href="../turing_hierarchical/">Hierarchical Models</a></li></ul></li><li class="is-active"><a class="tocitem" href>Model Comparison</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Data-Generating-Model"><span>Data-Generating Model</span></a></li><li><a class="tocitem" href="#Define-Models"><span>Define Models</span></a></li><li><a class="tocitem" href="#LBA-2"><span>LBA</span></a></li><li><a class="tocitem" href="#Estimate-Marginal-Log-Likelihood"><span>Estimate Marginal Log Likelihood</span></a></li><li><a class="tocitem" href="#Extract-marginal-log-likelihood"><span>Extract marginal log likelihood</span></a></li><li><a class="tocitem" href="#Compute-the-Bayes-Factor"><span>Compute the Bayes Factor</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../predictive_distributions/">Predictive Distributions</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Plotting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basic_plot_example/">Basic Example</a></li><li><a class="tocitem" href="../layout/">Changing the Layout</a></li><li><a class="tocitem" href="../plot_model/">Plot Model Process</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../developer_guide/">Developer Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Model Comparison</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Comparison</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl/blob/master/docs/src/bayes_factor.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-the-Bayes-Factor"><a class="docs-heading-anchor" href="#Computing-the-Bayes-Factor">Computing the Bayes Factor</a><a id="Computing-the-Bayes-Factor-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-Bayes-Factor" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>In this tutorial, we will use the Bayes factor to compare the evidence for one model relative to another reference model. Computing the Bayes factor is challenging because it requires integrating the log likelihood over the model parameters. One method for approximating this complex integral is non-reversible parallel tempering (Bouchard-Côté et al., 2022) using  <a href="https://julia-tempering.github.io/Pigeons.jl/dev/">Pigeons.jl</a>. </p><p>In the tutorial below, we will compare two models which differ only in terms of assumptions about drift rate variability: the LBA and the RDM. The LBA assumes that the drift rate varies across trials and is otherwise deterministic, whereas the RDM assumes the drift rate varies within a trial as Gaussian noise, but not across trials. The difference between the models can be visualized with Plots.jl:</p><h3 id="RDM"><a class="docs-heading-anchor" href="#RDM">RDM</a><a id="RDM-1"></a><a class="docs-heading-anchor-permalink" href="#RDM" title="Permalink"></a></h3><pre><code class="language-julia hljs">using SequentialSamplingModels
using Plots
using Random
Random.seed!(77)

dist = RDM()
density_kwargs=(;t_range=range(.20, 1.0, length=100),)
plot_model(dist; n_sim=1, density_kwargs, xlims=(0,1.0))</code></pre><img src="b4c8e0b6.svg" alt="Example block output"/><h3 id="LBA"><a class="docs-heading-anchor" href="#LBA">LBA</a><a id="LBA-1"></a><a class="docs-heading-anchor-permalink" href="#LBA" title="Permalink"></a></h3><pre><code class="language-julia hljs">using SequentialSamplingModels
using Plots
using Random

dist = LBA()
density_kwargs=(;t_range=range(.20, 1.0, length=100),)
plot_model(dist; n_sim=1, density_kwargs, xlims=(0,1.0))</code></pre><img src="06fc06e3.svg" alt="Example block output"/><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>Before proceeding, we will load the required packages.</p><pre><code class="language-julia hljs">using LinearAlgebra
using Pigeons
using Random
using SequentialSamplingModels
using Turing</code></pre><h2 id="Data-Generating-Model"><a class="docs-heading-anchor" href="#Data-Generating-Model">Data-Generating Model</a><a id="Data-Generating-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Generating-Model" title="Permalink"></a></h2><p>The next step is to generate simulated data for comparing the models. Here, we will assume that the LBA is the true data generating model:</p><pre><code class="language-julia hljs">Random.seed!(654)
dist = LBA(ν=[3.0, 2.0], A=0.8, k=0.2, τ=0.3)
data = rand(dist, 100)</code></pre><h2 id="Define-Models"><a class="docs-heading-anchor" href="#Define-Models">Define Models</a><a id="Define-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Models" title="Permalink"></a></h2><p>The following code blocks define the models along with their prior distributions using <a href="https://turinglang.org/stable/">Turing.jl</a>. Notice that the models are identical except for the log likelihood function.</p><h3 id="RDM-2"><a class="docs-heading-anchor" href="#RDM-2">RDM</a><a class="docs-heading-anchor-permalink" href="#RDM-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">@model function rdm(data; min_rt=minimum(data.rt))
    ν ~ MvNormal(fill(2.0, 2), I * 3)
    A ~ truncated(Normal(0.8, 0.8), 0.0, Inf)
    k ~ truncated(Normal(0.2, 0.2), 0.0, Inf)
    τ ~ Uniform(0.0, min_rt)
    data ~ RDM(; ν, A, k, τ)
end</code></pre><h2 id="LBA-2"><a class="docs-heading-anchor" href="#LBA-2">LBA</a><a class="docs-heading-anchor-permalink" href="#LBA-2" title="Permalink"></a></h2><pre><code class="language-julia hljs">@model function lba(data; min_rt=minimum(data.rt))
    ν ~ MvNormal(fill(2.0, 2), I * 3)
    A ~ truncated(Normal(0.8, 0.8), 0.0, Inf)
    k ~ truncated(Normal(0.2, 0.2), 0.0, Inf)
    τ ~ Uniform(0.0, min_rt)
    data ~ LBA(; ν, A, k, τ)
end</code></pre><h2 id="Estimate-Marginal-Log-Likelihood"><a class="docs-heading-anchor" href="#Estimate-Marginal-Log-Likelihood">Estimate Marginal Log Likelihood</a><a id="Estimate-Marginal-Log-Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-Marginal-Log-Likelihood" title="Permalink"></a></h2><p>The next step is to run the <code>pigeons</code> function to estimate the marginal log likelihood for each model. </p><h3 id="LBA-3"><a class="docs-heading-anchor" href="#LBA-3">LBA</a><a class="docs-heading-anchor-permalink" href="#LBA-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">pt_lba = pigeons(target=TuringLogPotential(lba(data)), record=[traces])</code></pre><pre><code class="language-julia hljs">────────────────────────────────────────────────────────────────────────────
  #scans       Λ      log(Z₁/Z₀)   min(α)     mean(α)    min(αₑ)   mean(αₑ) 
────────── ────────── ────────── ────────── ────────── ────────── ──────────
        2        3.3      -24.5   4.43e-56      0.634          1          1 
        4       1.88       42.2      0.331      0.791          1          1 
        8       3.05       40.2     0.0393      0.661          1          1 
       16       3.33       41.1      0.364       0.63          1          1 
       32       3.05       41.3      0.396      0.662          1          1 
       64       3.52       40.6      0.423      0.609          1          1 
      128       3.26       41.4       0.56      0.638          1          1 
      256       3.45       40.8      0.564      0.617          1          1 
      512       3.48       40.8      0.578      0.613          1          1 
 1.02e+03       3.33       40.9      0.596      0.629          1          1 
────────────────────────────────────────────────────────────────────────────</code></pre><h3 id="RDM-3"><a class="docs-heading-anchor" href="#RDM-3">RDM</a><a class="docs-heading-anchor-permalink" href="#RDM-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">pt_rdm = pigeons(target=TuringLogPotential(rdm(data)), record=[traces])</code></pre><pre><code class="language-julia hljs">────────────────────────────────────────────────────────────────────────────
  #scans       Λ      log(Z₁/Z₀)   min(α)     mean(α)    min(αₑ)   mean(αₑ) 
────────── ────────── ────────── ────────── ────────── ────────── ──────────
        2       4.73       31.6   0.000606      0.475          1          1 
        4       2.83       43.1       0.42      0.686          1          1 
        8       3.05       39.8    0.00128      0.661          1          1 
       16       3.46       41.2      0.268      0.615          1          1 
       32       3.81       40.9      0.328      0.577          1          1 
       64       3.16       40.6      0.404      0.649          1          1 
      128       3.26       41.3      0.569      0.638          1          1 
      256        3.3       40.6       0.56      0.633          1          1 
      512       3.38       40.9       0.55      0.625          1          1 
 1.02e+03       3.45       40.7      0.589      0.617          1          1</code></pre><h2 id="Extract-marginal-log-likelihood"><a class="docs-heading-anchor" href="#Extract-marginal-log-likelihood">Extract marginal log likelihood</a><a id="Extract-marginal-log-likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-marginal-log-likelihood" title="Permalink"></a></h2><p>In the following code block, the function <code>stepping_stone</code> extracts that marginal log likelihood:</p><pre><code class="language-julia hljs">mll_lba = stepping_stone(pt_lba)
mll_rdm = stepping_stone(pt_rdm)</code></pre><h2 id="Compute-the-Bayes-Factor"><a class="docs-heading-anchor" href="#Compute-the-Bayes-Factor">Compute the Bayes Factor</a><a id="Compute-the-Bayes-Factor-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-the-Bayes-Factor" title="Permalink"></a></h2><p>The bayes factor is obtained by exponentiating the difference between marginal log likelihoods. The value of <code>1.21</code> indicates that the LBA is <code>1.21</code> times more likely to have generated the data. </p><pre><code class="language-julia hljs">bf = exp(mll_lba - mll_rdm)</code></pre><pre><code class="language-julia hljs">1.2070298459526883</code></pre><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><p>Syed, S., Bouchard-Côté, A., Deligiannidis, G., &amp; Doucet, A. (2022). Non-reversible parallel tempering: a scalable highly parallel MCMC scheme. Journal of the Royal Statistical Society Series B: Statistical Methodology, 84(2), 321-350.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../turing_hierarchical/">« Hierarchical Models</a><a class="docs-footer-nextpage" href="../predictive_distributions/">Predictive Distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 4 July 2024 12:52">Thursday 4 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
